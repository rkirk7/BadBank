{"ast":null,"code":"const {\n  initializeApp\n} = require(\"firebase/app\");\nconst {\n  getAuth,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  browserSessionPersistence,\n  setPersistence,\n  signOut\n} = require(\"firebase/auth\");\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDhKNCusOPW2y52bMwLnOrXIy-u1y1Q4KI\",\n  authDomain: \"bank-f0c47.firebaseapp.com\",\n  projectId: \"bank-f0c47\",\n  storageBucket: \"bank-f0c47.appspot.com\",\n  messagingSenderId: \"710670974978\",\n  appId: \"1:710670974978:web:b724e76530555264b8271b\"\n};\nconst firebaseApp = initializeApp(firebaseConfig);\nconst auth = getAuth();\nsetPersistence(auth, browserSessionPersistence);\nasync function createFirebase(name, email, password, requestedRole, setCurrentUser) {\n  if (!db) {\n    throw new Error('Database connection not established');\n  }\n  try {\n    (async () => {\n      const url = \"/account/checkaccount/\".concat(email);\n      let res = await fetch(url);\n      if (res) {\n        return 'Account exists';\n      } else {\n        await createUserWithEmailAndPassword(auth, email, password);\n        (async () => {\n          const url = \"/account/createaccount/\".concat(name, \"/\").concat(email, \"/\").concat(requestedRole);\n          let res = await fetch(url);\n          if (res) {\n            var data = await res.json();\n            setCurrentUser(user => ({\n              email: data.email,\n              name: data.name,\n              balance: data.balance,\n              role: data.role\n            }));\n            return 'Account created';\n          } else {\n            return 'Error';\n          }\n        })();\n      }\n    })();\n  } catch (error) {\n    console.error('Error creating user with Firebase:', error.code, error.message);\n    return 'Error';\n  }\n}\nasync function loginFirebase(email, password, setCurrentUser) {\n  try {\n    await signInWithEmailAndPassword(auth, email, password);\n    console.log('firebase sign in successful');\n    (async () => {\n      const url = \"/account/login/\".concat(email);\n      let res = await fetch(url);\n      if (res) {\n        var data = await res.json();\n        setCurrentUser(user => ({\n          email: data.email,\n          name: data.name,\n          balance: data.balance,\n          role: data.role\n        }));\n        return true;\n      } else {\n        return false;\n      }\n    })();\n  } catch (error) {\n    console.error('Error logging in with Firebase:', error.code, error.message);\n    return error;\n  }\n}\nasync function logout() {\n  try {\n    await signOut(auth);\n    return true;\n  } catch (error) {\n    console.error('Error during logout:', error);\n    return false;\n  }\n}\nasync function checkAuthorization(setCurrentUser) {\n  const user = auth.currentUser;\n  if (user) {\n    const url = \"/authorization/\".concat(user.email);\n    (async () => {\n      let res = await fetch(url);\n      if (res) {\n        var data = await res.json();\n        setCurrentUser(user => ({\n          email: data.email,\n          name: data.name,\n          balance: data.balance,\n          role: data.role\n        }));\n        return true;\n      } else {\n        return false;\n      }\n    })();\n  } else {\n    return false;\n  }\n}\nmodule.exports = {\n  createFirebase,\n  loginFirebase,\n  logout,\n  checkAuthorization\n};","map":{"version":3,"names":["initializeApp","require","getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","browserSessionPersistence","setPersistence","signOut","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","firebaseApp","auth","createFirebase","name","email","password","requestedRole","setCurrentUser","db","Error","url","concat","res","fetch","data","json","user","balance","role","error","console","code","message","loginFirebase","log","logout","checkAuthorization","currentUser","module","exports"],"sources":["/Users/Regan/Documents/GitHub/BadBank/public/src/Components/firebase.js"],"sourcesContent":["const { initializeApp } = require(\"firebase/app\");\nconst { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, browserSessionPersistence, setPersistence, signOut } = require(\"firebase/auth\");\n\nconst firebaseConfig = {\n    apiKey: \"AIzaSyDhKNCusOPW2y52bMwLnOrXIy-u1y1Q4KI\",\n    authDomain: \"bank-f0c47.firebaseapp.com\",\n    projectId: \"bank-f0c47\",\n    storageBucket: \"bank-f0c47.appspot.com\",\n    messagingSenderId: \"710670974978\",\n    appId: \"1:710670974978:web:b724e76530555264b8271b\"\n  };\n  \n  const firebaseApp = initializeApp(firebaseConfig);\n  const auth = getAuth();\n  setPersistence(auth, browserSessionPersistence);\n\n  async function createFirebase(name, email, password, requestedRole, setCurrentUser) {\n    if (!db) {\n        throw new Error('Database connection not established');\n    }\n    try {\n        (async () => {\n            const url = `/account/checkaccount/${email}`;\n            let res = await fetch(url);\n            if (res) {\n           return 'Account exists';\n        } else {\n            await createUserWithEmailAndPassword(auth, email, password);\n                (async () => {\n                    const url = `/account/createaccount/${name}/${email}/${requestedRole}`;\n                    let res = await fetch(url);\n                    if (res) {\n                    var data = await res.json();\n                \n                    setCurrentUser(user => ({\n                        email: data.email,\n                        name: data.name,\n                        balance: data.balance,\n                        role: data.role\n                   })); \n                   return 'Account created'\n                } else {\n                    return 'Error';\n                }\n                })();\n                }\n                })()\n      } catch (error) {\n        console.error('Error creating user with Firebase:', error.code, error.message);\n        return 'Error';\n      }\n            \n  }\n\n  async function loginFirebase(email, password, setCurrentUser) {\n    try {\n        await signInWithEmailAndPassword(auth, email, password);\n        console.log('firebase sign in successful');\n\n        (async () => {\n            const url = `/account/login/${email}`;\n            let res = await fetch(url);\n            if (res) {\n            var data = await res.json();\n        \n            setCurrentUser(user => ({\n                email: data.email,\n                name: data.name,\n                balance: data.balance,\n                role: data.role\n           })); \n           return true;\n        } else {\n            return false;\n        }\n        })();\n    } catch (error) {\n        console.error('Error logging in with Firebase:', error.code, error.message);\n        return(error);\n    }\n}\n\nasync function logout() {\n    try {\n        await signOut(auth);\n        return true;\n    } catch (error) {\n        console.error('Error during logout:', error);\n        return false;\n    }\n}\n\nasync function checkAuthorization(setCurrentUser) {\n    const user = auth.currentUser;\n\n    if (user) {\n        const url = `/authorization/${user.email}`;\n\n        (async () => {\n            let res = await fetch(url);\n            if (res) {\n            var data = await res.json();\n        \n            setCurrentUser(user => ({\n                email: data.email,\n                name: data.name,\n                balance: data.balance,\n                role: data.role\n           })); \n           return true;\n        } else {\n            return false;\n        }\n        })();\n    } else {\n     return false;\n    }\n}\n\n  module.exports = {createFirebase, loginFirebase, logout, checkAuthorization}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}