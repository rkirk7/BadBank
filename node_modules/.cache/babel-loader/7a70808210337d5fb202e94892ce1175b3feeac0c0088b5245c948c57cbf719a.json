{"ast":null,"code":"import React from \"react\";\nimport { Table, CurrentUser } from \"./context\";\nimport { useNavigate } from \"react-router-dom\";\nexport default function AllData() {\n  const navigate = useNavigate();\n  const {\n    currentUser\n  } = React.useContext(CurrentUser);\n  const [data, setData] = React.useState([]);\n  const [loading, setLoading] = React.useState(true);\n  const [activityData, setActivityData] = React.useState([]);\n  const [showAllUsers, setShowAllUsers] = React.useState(true);\n  const [showActivity, setShowActivity] = React.useState(true);\n  const [userSearch, setUserSearch] = React.useState('');\n  const [activitySearch, setActivitySearch] = React.useState('');\n  React.useEffect(() => {\n    if (currentUser.email === '') {\n      reviewAuthorization();\n    }\n  }, []);\n  const authorizationURL = \"/account/authorization/\";\n  async function reviewAuthorization() {\n    var res = await fetch(authorizationURL);\n    if (res.ok) {\n      let user = await res.json();\n      if (!user.email) {\n        setTimeout(() => {\n          navigate('/');\n        }, 0);\n      } else {\n        let userList;\n        if (currentUser.role === 'admin') {\n          React.useEffect(() => {\n            fetch('/account/all').then(response => response.json()).then(data => {\n              setData(data);\n              setLoading(false);\n            });\n          }, []);\n          let userSearchQuery = data.filter(user => {\n            return user.email && user.email.toLowerCase().includes(userSearch.toLowerCase());\n          }) || [];\n          userList = userSearchQuery.map(user => /*#__PURE__*/React.createElement(\"tr\", {\n            key: user._id\n          }, /*#__PURE__*/React.createElement(\"td\", null, user.name), /*#__PURE__*/React.createElement(\"td\", null, \"$\", user.balance), /*#__PURE__*/React.createElement(\"td\", null, user.email), /*#__PURE__*/React.createElement(\"td\", null, user._id)));\n        }\n        React.useEffect(() => {\n          fetch(\"/account/getActivity/\".concat(currentUser.email, \"/\").concat(currentUser.role)).then(response => response.json()).then(newData => {\n            setActivityData(newData);\n            setLoading(false);\n          });\n        }, []);\n        let activitySearchQuery = activityData.filter(account => {\n          return account.email && account.email.toLowerCase().includes(activitySearch.toLowerCase());\n        }) || [];\n        let activityList = activitySearchQuery.slice().reverse().map(account => /*#__PURE__*/React.createElement(\"tr\", {\n          key: account._id\n        }, /*#__PURE__*/React.createElement(\"td\", null, account.email), /*#__PURE__*/React.createElement(\"td\", null, account.activity), /*#__PURE__*/React.createElement(\"td\", null, new Date(account.date).toLocaleString())));\n      }\n    }\n    ;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, !loading && /*#__PURE__*/React.createElement(\"div\", null, currentUser.role === \"admin\" && /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"tableheader\"\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      className: \"myLink\",\n      onClick: () => setShowAllUsers(!showAllUsers)\n    }, \"Admin: All Users\")), showAllUsers && /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'center',\n        marginBottom: '10px'\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Search by Email\",\n      value: userSearch,\n      onChange: e => {\n        setUserSearch(e.currentTarget.value);\n      }\n    })), showAllUsers && /*#__PURE__*/React.createElement(Table, {\n      id: \"usertable\",\n      col1: \"Name\",\n      col2: \"Balance\",\n      col3: \"Email\",\n      col4: \"ID\",\n      list: userList\n    })), /*#__PURE__*/React.createElement(\"div\", null, currentUser.role === \"admin\" ? /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"tableheader\"\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      className: \"myLink\",\n      onClick: () => setShowActivity(!showActivity)\n    }, \"Admin: All Bank Activity\")), showActivity && /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'center',\n        marginBottom: '10px'\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Search by Email\",\n      value: activitySearch,\n      onChange: e => {\n        setActivitySearch(e.currentTarget.value);\n      }\n    }))) : /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"tableheader\"\n    }, \"My Activity\"), showActivity && /*#__PURE__*/React.createElement(Table, {\n      id: \"activitytable\",\n      col1: \"Email\",\n      col2: \"Activity\",\n      col3: \"Date\",\n      list: activityList\n    }))), \";\");\n  }\n}","map":{"version":3,"names":["React","Table","CurrentUser","useNavigate","AllData","navigate","currentUser","useContext","data","setData","useState","loading","setLoading","activityData","setActivityData","showAllUsers","setShowAllUsers","showActivity","setShowActivity","userSearch","setUserSearch","activitySearch","setActivitySearch","useEffect","email","reviewAuthorization","authorizationURL","res","fetch","ok","user","json","setTimeout","userList","role","then","response","userSearchQuery","filter","toLowerCase","includes","map","createElement","key","_id","name","balance","concat","newData","activitySearchQuery","account","activityList","slice","reverse","activity","Date","date","toLocaleString","Fragment","className","onClick","style","display","justifyContent","marginBottom","type","placeholder","value","onChange","e","currentTarget","id","col1","col2","col3","col4","list"],"sources":["/Users/Regan/Documents/GitHub/BadBank/public/src/Components/alldata.js"],"sourcesContent":["import React from \"react\";\nimport {Table, CurrentUser} from \"./context\";\nimport { useNavigate } from \"react-router-dom\";\n\n\nexport default function AllData(){\n  const navigate = useNavigate();\n\n  const { currentUser } = React.useContext(CurrentUser);\n  const [data, setData] = React.useState([]);\n  const [loading, setLoading] = React.useState(true);\n  const [activityData, setActivityData] = React.useState([]);\n  const [showAllUsers, setShowAllUsers] = React.useState(true);\n  const [showActivity, setShowActivity] = React.useState(true);\n  const [userSearch, setUserSearch] = React.useState('');\n  const [activitySearch, setActivitySearch] = React.useState('');\n\n\n\n  React.useEffect(() => {\n    if (currentUser.email === '') {\n    reviewAuthorization();\n    } \n  }, []);\n\n  const authorizationURL = `/account/authorization/`;\n  async function reviewAuthorization() {\n     var res = await fetch(authorizationURL);\n     if (res.ok) {\n     let user = await res.json();\n     if (!user.email) {\n         setTimeout(() => {\n          navigate('/');\n      }, 0);\n    } else {\n      let userList;\n\n      if (currentUser.role === 'admin') {\n      React.useEffect(() => {\n        fetch('/account/all')\n        .then(response => response.json())\n        .then(data => {\n          setData(data);\n          setLoading(false);\n        });\n      }, []);\n    \n      let userSearchQuery = data.filter((user) => {\n        return user.email && user.email.toLowerCase().includes(userSearch.toLowerCase());\n      }) || [];\n      \n    userList = userSearchQuery.map(user => (\n        <tr key={user._id}>\n          <td>{user.name}</td>\n          <td>${user.balance}</td>\n          <td>{user.email}</td>\n          <td>{user._id}</td>\n        </tr>\n      ));\n    }\n    \n    React.useEffect(() => {\n      fetch(`/account/getActivity/${currentUser.email}/${currentUser.role}`)\n      .then(response => response.json())\n      .then(newData => {\n        setActivityData(newData);\n        setLoading(false);\n      });\n    }, []);\n    \n    let activitySearchQuery = activityData.filter((account) => {\n      return account.email && account.email.toLowerCase().includes(activitySearch.toLowerCase());\n    }) || [];\n    \n    \n    let activityList = activitySearchQuery.slice().reverse().map(account => (\n      <tr key={account._id}>\n        <td>{account.email}</td>\n        <td>{account.activity}</td>\n        <td>{new Date(account.date).toLocaleString()}</td>\n      </tr>\n    ));\n    }\n    }; \n\nreturn (\n  <>\n      {!loading && (\n  <div>\n      {currentUser.role === \"admin\" && (\n        <div>\n         <h1 className=\"tableheader\"><a  className=\"myLink\" onClick={ () => setShowAllUsers(!showAllUsers) }>Admin: All Users</a></h1>\n        { showAllUsers && ( <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '10px' }}>\n         <input type=\"text\" placeholder=\"Search by Email\" value={userSearch} onChange={e => {\n                setUserSearch(e.currentTarget.value);\n                }}></input>\n                </div>\n                )}\n      \n      {showAllUsers && (\n      \n  <Table\n  id=\"usertable\"\n  col1=\"Name\"\n  col2=\"Balance\"\n  col3=\"Email\"\n  col4=\"ID\"\n  list={userList}\n  />\n      )}\n      </div>\n     )}\n     <div>\n     {currentUser.role === \"admin\" ? (\n      <div>\n     <h1 className=\"tableheader\"><a className=\"myLink\" onClick= { () => setShowActivity(!showActivity)}>Admin: All Bank Activity</a></h1>\n     {showActivity && (\n      <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '10px' }}>\n        <input type=\"text\" placeholder=\"Search by Email\" value={activitySearch} onChange={e => {setActivitySearch(e.currentTarget.value);\n        }}>\n        </input>\n        </div>\n              )}\n     </div>\n     \n     ) : (\n      <h1 className=\"tableheader\">My Activity</h1>\n     ) }\n\n      {showActivity && (\n\n<Table\n  id=\"activitytable\"\n  col1=\"Email\"\n  col2=\"Activity\"\n  col3=\"Date\"\n  list={activityList}\n  />\n      )}\n  </div>\n  </div>\n      )};\n  </>\n);\n}\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}