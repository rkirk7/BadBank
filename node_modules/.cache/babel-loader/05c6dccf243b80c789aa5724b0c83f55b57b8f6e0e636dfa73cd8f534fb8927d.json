{"ast":null,"code":"const {\n  initializeApp\n} = require(\"firebase/app\");\nconst {\n  getAuth,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  setPersistence,\n  signOut,\n  onAuthStateChanged,\n  browserLocalPersistence,\n  browserSessionPersistence\n} = require(\"firebase/auth\");\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDhKNCusOPW2y52bMwLnOrXIy-u1y1Q4KI\",\n  authDomain: \"bank-f0c47.firebaseapp.com\",\n  projectId: \"bank-f0c47\",\n  storageBucket: \"bank-f0c47.appspot.com\",\n  messagingSenderId: \"710670974978\",\n  appId: \"1:710670974978:web:b724e76530555264b8271b\"\n};\nconst firebaseApp = initializeApp(firebaseConfig);\nconst auth = getAuth();\nasync function createFirebase(name, email, password, persistence, requestedRole, setCurrentUser) {\n  try {\n    let thePersistence = browserSessionPersistence;\n    if (persistence) {\n      thePersistence = browserLocalPersistence;\n    }\n    await setPersistence(auth, thePersistence);\n    const checkUrl = \"/account/checkaccount/\".concat(email);\n    let res = await fetch(checkUrl);\n    let accountExists = await res.json();\n    if (accountExists) {\n      return 'Account exists';\n    } else {\n      await createUserWithEmailAndPassword(auth, email, password, requestedRole);\n      const createUrl = \"/account/createaccount/\".concat(name, \"/\").concat(email, \"/\").concat(requestedRole);\n      let createRes = await fetch(createUrl);\n      if (createRes.ok) {\n        let data = await createRes.json();\n        setCurrentUser(user => ({\n          email: data.email,\n          name: data.name,\n          balance: data.balance,\n          role: data.role\n        }));\n        return 'Account created';\n      } else {\n        return 'Error';\n      }\n    }\n  } catch (error) {\n    console.error('Error creating user with Firebase:', error.code, error.message);\n    return 'Error';\n  }\n}\nasync function loginFirebase(email, password, persistence, setCurrentUser) {\n  try {\n    let thePersistence = browserSessionPersistence;\n    if (persistence) {\n      thePersistence = browserLocalPersistence;\n    }\n    await setPersistence(auth, thePersistence);\n    await signInWithEmailAndPassword(auth, email, password);\n    const url = \"/account/login/\".concat(email);\n    let res = await fetch(url);\n    if (res) {\n      var data = await res.json();\n      setCurrentUser(user => ({\n        email: data.email,\n        name: data.name,\n        balance: data.balance,\n        role: data.role\n      }));\n      return true;\n    } else {\n      setCurrentUser(user => ({\n        email: '',\n        name: '',\n        balance: '',\n        role: ''\n      }));\n      return false;\n    }\n  } catch (error) {\n    setCurrentUser(user => ({\n      email: '',\n      name: '',\n      balance: '',\n      role: ''\n    }));\n    console.error('Error logging in with Firebase:', error.code, error.message);\n    return false;\n  }\n}\nasync function logout() {\n  try {\n    await signOut(auth);\n    return true;\n  } catch (error) {\n    console.error('Error during logout:', error);\n    return false;\n  }\n}\nasync function checkAuthorization(setCurrentUser) {\n  onAuthStateChanged(auth, async user => {\n    if (user) {\n      console.log(\"\".concat(user.email, \" is logged in\"));\n      const url = \"/authorization/\".concat(user.email);\n      let res = await fetch(url);\n      if (res.ok) {\n        let data = await res.json();\n        setCurrentUser(user => ({\n          email: data.email,\n          name: data.name,\n          balance: data.balance,\n          role: data.role\n        }));\n        return true;\n      } else {\n        setCurrentUser(user => ({\n          email: '',\n          name: '',\n          balance: '',\n          role: ''\n        }));\n        return false;\n      }\n    } else {\n      setCurrentUser(user => ({\n        email: '',\n        name: '',\n        balance: '',\n        role: ''\n      }));\n      return false;\n    }\n  });\n}\nexport async function getBalance(setCurrentUser, email) {\n  try {\n    const url = \"/account/balance/\".concat(email);\n    const res = await fetch(url);\n    const data = await res.json();\n    setCurrentUser(user => ({\n      ...user,\n      balance: parseInt(data.balance, 10)\n    }));\n  } catch (error) {\n    console.error('Failed to fetch balance:', error);\n  }\n}\nmodule.exports = {\n  createFirebase,\n  loginFirebase,\n  logout,\n  checkAuthorization,\n  getBalance\n};","map":{"version":3,"names":["initializeApp","require","getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","setPersistence","signOut","onAuthStateChanged","browserLocalPersistence","browserSessionPersistence","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","firebaseApp","auth","createFirebase","name","email","password","persistence","requestedRole","setCurrentUser","thePersistence","checkUrl","concat","res","fetch","accountExists","json","createUrl","createRes","ok","data","user","balance","role","error","console","code","message","loginFirebase","url","logout","checkAuthorization","log","getBalance","parseInt","module","exports"],"sources":["/Users/Regan/Documents/GitHub/BadBank/public/src/Components/firebase.js"],"sourcesContent":["const { initializeApp } = require(\"firebase/app\");\nconst { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, setPersistence, signOut, onAuthStateChanged, browserLocalPersistence, browserSessionPersistence } = require(\"firebase/auth\");\n\nconst firebaseConfig = {\n    apiKey: \"AIzaSyDhKNCusOPW2y52bMwLnOrXIy-u1y1Q4KI\",\n    authDomain: \"bank-f0c47.firebaseapp.com\",\n    projectId: \"bank-f0c47\",\n    storageBucket: \"bank-f0c47.appspot.com\",\n    messagingSenderId: \"710670974978\",\n    appId: \"1:710670974978:web:b724e76530555264b8271b\"\n  };\n  \n  const firebaseApp = initializeApp(firebaseConfig);\n  const auth = getAuth();\n\n  async function createFirebase(name, email, password, persistence, requestedRole, setCurrentUser) {\n    try {\n        let thePersistence = browserSessionPersistence\n        if (persistence) {\n            thePersistence = browserLocalPersistence;\n        } \n            await setPersistence(auth, thePersistence);\n            const checkUrl = `/account/checkaccount/${email}`;\n            let res = await fetch(checkUrl);\n            let accountExists = await res.json();\n            if (accountExists) {\n           return 'Account exists';\n        } else {\n            await createUserWithEmailAndPassword(auth, email, password, requestedRole);\n            const createUrl = `/account/createaccount/${name}/${email}/${requestedRole}`;\n            let createRes = await fetch(createUrl);\n            if (createRes.ok) {\n            let data = await createRes.json();  \n             setCurrentUser(user => ({\n                email: data.email,\n                name: data.name,\n                balance: data.balance,\n                role: data.role\n                   })); \n            return 'Account created'\n                } else {\n                    return 'Error';\n                  }\n                }\n      } catch (error) {\n        console.error('Error creating user with Firebase:', error.code, error.message);\n        return 'Error';\n      }\n  }\n\n  async function loginFirebase(email, password, persistence, setCurrentUser) {\n    try {\n        let thePersistence = browserSessionPersistence\n        if (persistence) {\n            thePersistence = browserLocalPersistence;\n        } \n            await setPersistence(auth, thePersistence);\n        await signInWithEmailAndPassword(auth, email, password);\n            const url = `/account/login/${email}`;\n            let res = await fetch(url);\n            if (res) {\n            var data = await res.json();\n        \n            setCurrentUser(user => ({\n                email: data.email,\n                name: data.name,\n                balance: data.balance,\n                role: data.role\n           })); \n           return true;\n        } else {\n            setCurrentUser(user => ({\n                email: '',\n                name: '',\n                balance: '',\n                role: ''\n           })); \n            return false;\n        }\n    } catch (error) {\n        setCurrentUser(user => ({\n            email: '',\n            name: '',\n            balance: '',\n            role: ''\n       })); \n        console.error('Error logging in with Firebase:', error.code, error.message);\n        return false;\n    }\n}\n\nasync function logout() {\n    try {\n        await signOut(auth);\n        return true;\n    } catch (error) {\n        console.error('Error during logout:', error);\n        return false;\n    }\n}\n\nasync function checkAuthorization(setCurrentUser) {\n    onAuthStateChanged(auth, async (user) => {\n        if (user) {\n            console.log(`${user.email} is logged in`);\n            const url = `/authorization/${user.email}`;\n            let res = await fetch(url);\n            if (res.ok) {\n                let data = await res.json();\n                setCurrentUser(user => ({\n                    email: data.email,\n                    name: data.name,\n                    balance: data.balance,\n                    role: data.role\n                }));\n                return true;\n            } else {\n                setCurrentUser(user => ({\n                    email: '',\n                    name: '',\n                    balance: '',\n                    role: ''\n                }));\n                return false;\n            }\n        } else {\n            setCurrentUser(user => ({\n                email: '',\n                name: '',\n                balance: '',\n                role: ''\n            }));\n            return false;\n        }\n    });\n}\n\nexport async function getBalance(setCurrentUser, email) {\n    try {\n        const url = `/account/balance/${email}`;\n        const res = await fetch(url);\n        const data = await res.json();\n        setCurrentUser(user => ({\n            ...user,\n            balance: parseInt(data.balance, 10)\n        }));\n    } catch (error) {\n        console.error('Failed to fetch balance:', error);\n    }\n}\n\n  module.exports = {createFirebase, loginFirebase, logout, checkAuthorization, getBalance}"],"mappings":"AAAA,MAAM;EAAEA;AAAc,CAAC,GAAGC,OAAO,CAAC,cAAc,CAAC;AACjD,MAAM;EAAEC,OAAO;EAAEC,8BAA8B;EAAEC,0BAA0B;EAAEC,cAAc;EAAEC,OAAO;EAAEC,kBAAkB;EAAEC,uBAAuB;EAAEC;AAA0B,CAAC,GAAGR,OAAO,CAAC,eAAe,CAAC;AAEzM,MAAMS,cAAc,GAAG;EACnBC,MAAM,EAAE,yCAAyC;EACjDC,UAAU,EAAE,4BAA4B;EACxCC,SAAS,EAAE,YAAY;EACvBC,aAAa,EAAE,wBAAwB;EACvCC,iBAAiB,EAAE,cAAc;EACjCC,KAAK,EAAE;AACT,CAAC;AAED,MAAMC,WAAW,GAAGjB,aAAa,CAACU,cAAc,CAAC;AACjD,MAAMQ,IAAI,GAAGhB,OAAO,CAAC,CAAC;AAEtB,eAAeiB,cAAcA,CAACC,IAAI,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,WAAW,EAAEC,aAAa,EAAEC,cAAc,EAAE;EAC/F,IAAI;IACA,IAAIC,cAAc,GAAGjB,yBAAyB;IAC9C,IAAIc,WAAW,EAAE;MACbG,cAAc,GAAGlB,uBAAuB;IAC5C;IACI,MAAMH,cAAc,CAACa,IAAI,EAAEQ,cAAc,CAAC;IAC1C,MAAMC,QAAQ,4BAAAC,MAAA,CAA4BP,KAAK,CAAE;IACjD,IAAIQ,GAAG,GAAG,MAAMC,KAAK,CAACH,QAAQ,CAAC;IAC/B,IAAII,aAAa,GAAG,MAAMF,GAAG,CAACG,IAAI,CAAC,CAAC;IACpC,IAAID,aAAa,EAAE;MACpB,OAAO,gBAAgB;IAC1B,CAAC,MAAM;MACH,MAAM5B,8BAA8B,CAACe,IAAI,EAAEG,KAAK,EAAEC,QAAQ,EAAEE,aAAa,CAAC;MAC1E,MAAMS,SAAS,6BAAAL,MAAA,CAA6BR,IAAI,OAAAQ,MAAA,CAAIP,KAAK,OAAAO,MAAA,CAAIJ,aAAa,CAAE;MAC5E,IAAIU,SAAS,GAAG,MAAMJ,KAAK,CAACG,SAAS,CAAC;MACtC,IAAIC,SAAS,CAACC,EAAE,EAAE;QAClB,IAAIC,IAAI,GAAG,MAAMF,SAAS,CAACF,IAAI,CAAC,CAAC;QAChCP,cAAc,CAACY,IAAI,KAAK;UACrBhB,KAAK,EAAEe,IAAI,CAACf,KAAK;UACjBD,IAAI,EAAEgB,IAAI,CAAChB,IAAI;UACfkB,OAAO,EAAEF,IAAI,CAACE,OAAO;UACrBC,IAAI,EAAEH,IAAI,CAACG;QACR,CAAC,CAAC,CAAC;QACV,OAAO,iBAAiB;MACpB,CAAC,MAAM;QACH,OAAO,OAAO;MAChB;IACF;EACV,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAACE,IAAI,EAAEF,KAAK,CAACG,OAAO,CAAC;IAC9E,OAAO,OAAO;EAChB;AACJ;AAEA,eAAeC,aAAaA,CAACvB,KAAK,EAAEC,QAAQ,EAAEC,WAAW,EAAEE,cAAc,EAAE;EACzE,IAAI;IACA,IAAIC,cAAc,GAAGjB,yBAAyB;IAC9C,IAAIc,WAAW,EAAE;MACbG,cAAc,GAAGlB,uBAAuB;IAC5C;IACI,MAAMH,cAAc,CAACa,IAAI,EAAEQ,cAAc,CAAC;IAC9C,MAAMtB,0BAA0B,CAACc,IAAI,EAAEG,KAAK,EAAEC,QAAQ,CAAC;IACnD,MAAMuB,GAAG,qBAAAjB,MAAA,CAAqBP,KAAK,CAAE;IACrC,IAAIQ,GAAG,GAAG,MAAMC,KAAK,CAACe,GAAG,CAAC;IAC1B,IAAIhB,GAAG,EAAE;MACT,IAAIO,IAAI,GAAG,MAAMP,GAAG,CAACG,IAAI,CAAC,CAAC;MAE3BP,cAAc,CAACY,IAAI,KAAK;QACpBhB,KAAK,EAAEe,IAAI,CAACf,KAAK;QACjBD,IAAI,EAAEgB,IAAI,CAAChB,IAAI;QACfkB,OAAO,EAAEF,IAAI,CAACE,OAAO;QACrBC,IAAI,EAAEH,IAAI,CAACG;MAChB,CAAC,CAAC,CAAC;MACH,OAAO,IAAI;IACd,CAAC,MAAM;MACHd,cAAc,CAACY,IAAI,KAAK;QACpBhB,KAAK,EAAE,EAAE;QACTD,IAAI,EAAE,EAAE;QACRkB,OAAO,EAAE,EAAE;QACXC,IAAI,EAAE;MACX,CAAC,CAAC,CAAC;MACF,OAAO,KAAK;IAChB;EACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;IACZf,cAAc,CAACY,IAAI,KAAK;MACpBhB,KAAK,EAAE,EAAE;MACTD,IAAI,EAAE,EAAE;MACRkB,OAAO,EAAE,EAAE;MACXC,IAAI,EAAE;IACX,CAAC,CAAC,CAAC;IACFE,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAACE,IAAI,EAAEF,KAAK,CAACG,OAAO,CAAC;IAC3E,OAAO,KAAK;EAChB;AACJ;AAEA,eAAeG,MAAMA,CAAA,EAAG;EACpB,IAAI;IACA,MAAMxC,OAAO,CAACY,IAAI,CAAC;IACnB,OAAO,IAAI;EACf,CAAC,CAAC,OAAOsB,KAAK,EAAE;IACZC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;IAC5C,OAAO,KAAK;EAChB;AACJ;AAEA,eAAeO,kBAAkBA,CAACtB,cAAc,EAAE;EAC9ClB,kBAAkB,CAACW,IAAI,EAAE,MAAOmB,IAAI,IAAK;IACrC,IAAIA,IAAI,EAAE;MACNI,OAAO,CAACO,GAAG,IAAApB,MAAA,CAAIS,IAAI,CAAChB,KAAK,kBAAe,CAAC;MACzC,MAAMwB,GAAG,qBAAAjB,MAAA,CAAqBS,IAAI,CAAChB,KAAK,CAAE;MAC1C,IAAIQ,GAAG,GAAG,MAAMC,KAAK,CAACe,GAAG,CAAC;MAC1B,IAAIhB,GAAG,CAACM,EAAE,EAAE;QACR,IAAIC,IAAI,GAAG,MAAMP,GAAG,CAACG,IAAI,CAAC,CAAC;QAC3BP,cAAc,CAACY,IAAI,KAAK;UACpBhB,KAAK,EAAEe,IAAI,CAACf,KAAK;UACjBD,IAAI,EAAEgB,IAAI,CAAChB,IAAI;UACfkB,OAAO,EAAEF,IAAI,CAACE,OAAO;UACrBC,IAAI,EAAEH,IAAI,CAACG;QACf,CAAC,CAAC,CAAC;QACH,OAAO,IAAI;MACf,CAAC,MAAM;QACHd,cAAc,CAACY,IAAI,KAAK;UACpBhB,KAAK,EAAE,EAAE;UACTD,IAAI,EAAE,EAAE;UACRkB,OAAO,EAAE,EAAE;UACXC,IAAI,EAAE;QACV,CAAC,CAAC,CAAC;QACH,OAAO,KAAK;MAChB;IACJ,CAAC,MAAM;MACHd,cAAc,CAACY,IAAI,KAAK;QACpBhB,KAAK,EAAE,EAAE;QACTD,IAAI,EAAE,EAAE;QACRkB,OAAO,EAAE,EAAE;QACXC,IAAI,EAAE;MACV,CAAC,CAAC,CAAC;MACH,OAAO,KAAK;IAChB;EACJ,CAAC,CAAC;AACN;AAEA,OAAO,eAAeU,UAAUA,CAACxB,cAAc,EAAEJ,KAAK,EAAE;EACpD,IAAI;IACA,MAAMwB,GAAG,uBAAAjB,MAAA,CAAuBP,KAAK,CAAE;IACvC,MAAMQ,GAAG,GAAG,MAAMC,KAAK,CAACe,GAAG,CAAC;IAC5B,MAAMT,IAAI,GAAG,MAAMP,GAAG,CAACG,IAAI,CAAC,CAAC;IAC7BP,cAAc,CAACY,IAAI,KAAK;MACpB,GAAGA,IAAI;MACPC,OAAO,EAAEY,QAAQ,CAACd,IAAI,CAACE,OAAO,EAAE,EAAE;IACtC,CAAC,CAAC,CAAC;EACP,CAAC,CAAC,OAAOE,KAAK,EAAE;IACZC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;EACpD;AACJ;AAEEW,MAAM,CAACC,OAAO,GAAG;EAACjC,cAAc;EAAEyB,aAAa;EAAEE,MAAM;EAAEC,kBAAkB;EAAEE;AAAU,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}