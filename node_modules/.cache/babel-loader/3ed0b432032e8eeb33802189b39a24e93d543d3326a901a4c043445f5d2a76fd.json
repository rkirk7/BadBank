{"ast":null,"code":"import React, { useEffect } from \"react\";\nimport { Table, CurrentUser } from \"./context\";\nimport { useNavigate } from \"react-router-dom\";\nimport { getBalance } from \"./loading\";\nimport { checkAuthorization } from \"./firebase\";\nexport default function AllData() {\n  const navigate = useNavigate();\n  const {\n    currentUser,\n    setCurrentUser\n  } = React.useContext(CurrentUser);\n  const [data, setData] = React.useState([]);\n  const [loading, setLoading] = React.useState(true);\n  const [activityData, setActivityData] = React.useState([]);\n  const [showAllUsers, setShowAllUsers] = React.useState(true);\n  const [showActivity, setShowActivity] = React.useState(true);\n  const [userSearch, setUserSearch] = React.useState('');\n  const [activitySearch, setActivitySearch] = React.useState('');\n  const [loggedIn, setLoggedIn] = React.useState(false);\n  useEffect(() => {\n    async function loadPage() {\n      if (currentUser.email === '') {\n        let res = await checkAuthorization(setCurrentUser);\n        if (res) {\n          console.log(\"home: user logged in\");\n          setLoading(false);\n        } else {\n          console.log(\"home: no user logged in\");\n          setLoading(false);\n          navigate('/');\n        }\n      }\n      setLoading(false);\n    }\n    loadPage();\n  }, []);\n  useEffect(() => {\n    async function loadPage() {\n      if (currentUser.email === '' || !currentUser) {\n        let res = await checkAuthorization(setCurrentUser);\n        if (!res) {\n          navigate('/');\n        }\n        setLoggedIn(true);\n      } else {\n        await getBalance(setCurrentUser, currentUser.email);\n        setLoggedIn(true);\n      }\n      setLoading(false);\n    }\n    loadPage();\n  }, []);\n  let userList;\n  if (currentUser.role === 'admin') {\n    React.useEffect(() => {\n      fetch('/account/all').then(response => response.json()).then(data => {\n        setData(data);\n        setLoading(false);\n      });\n    }, [loggedIn]);\n    let userSearchQuery = data.filter(user => {\n      return user.email && user.email.toLowerCase().includes(userSearch.toLowerCase());\n    }) || [];\n    userList = userSearchQuery.map(user => /*#__PURE__*/React.createElement(\"tr\", {\n      key: user._id\n    }, /*#__PURE__*/React.createElement(\"td\", null, user.name), /*#__PURE__*/React.createElement(\"td\", null, \"$\", user.balance), /*#__PURE__*/React.createElement(\"td\", null, user.email), /*#__PURE__*/React.createElement(\"td\", null, user._id)));\n  }\n  React.useEffect(() => {\n    fetch(\"/account/getActivity/\".concat(currentUser.email, \"/\").concat(currentUser.role)).then(response => response.json()).then(newData => {\n      setActivityData(newData);\n      setLoading(false);\n    });\n  }, [loggedIn]);\n  let activitySearchQuery = activityData.filter(account => {\n    return account.email && account.email.toLowerCase().includes(activitySearch.toLowerCase());\n  }) || [];\n  let activityList = activitySearchQuery.slice().reverse().map(account => /*#__PURE__*/React.createElement(\"tr\", {\n    key: account._id\n  }, /*#__PURE__*/React.createElement(\"td\", null, account.email), /*#__PURE__*/React.createElement(\"td\", null, account.activity), /*#__PURE__*/React.createElement(\"td\", null, new Date(account.date).toLocaleString())));\n  return /*#__PURE__*/React.createElement(React.Fragment, null, !loading && /*#__PURE__*/React.createElement(\"div\", null, currentUser.role === \"admin\" && /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"tableheader\"\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    className: \"myLink\",\n    onClick: () => setShowAllUsers(!showAllUsers)\n  }, \"Admin: All Users\")), showAllUsers && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      marginBottom: '10px'\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Search by Email\",\n    value: userSearch,\n    onChange: e => {\n      setUserSearch(e.currentTarget.value);\n    }\n  })), showAllUsers && /*#__PURE__*/React.createElement(Table, {\n    id: \"usertable\",\n    col1: \"Name\",\n    col2: \"Balance\",\n    col3: \"Email\",\n    col4: \"ID\",\n    list: userList\n  })), /*#__PURE__*/React.createElement(\"div\", null, currentUser.role === \"admin\" ? /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"tableheader\"\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    className: \"myLink\",\n    onClick: () => setShowActivity(!showActivity)\n  }, \"Admin: All Bank Activity\")), showActivity && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      marginBottom: '10px'\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Search by Email\",\n    value: activitySearch,\n    onChange: e => {\n      setActivitySearch(e.currentTarget.value);\n    }\n  }))) : /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"tableheader\"\n  }, \"My Activity\"), showActivity && /*#__PURE__*/React.createElement(Table, {\n    id: \"activitytable\",\n    col1: \"Email\",\n    col2: \"Activity\",\n    col3: \"Date\",\n    list: activityList\n  }))), \";\");\n}","map":{"version":3,"names":["React","useEffect","Table","CurrentUser","useNavigate","getBalance","checkAuthorization","AllData","navigate","currentUser","setCurrentUser","useContext","data","setData","useState","loading","setLoading","activityData","setActivityData","showAllUsers","setShowAllUsers","showActivity","setShowActivity","userSearch","setUserSearch","activitySearch","setActivitySearch","loggedIn","setLoggedIn","loadPage","email","res","console","log","userList","role","fetch","then","response","json","userSearchQuery","filter","user","toLowerCase","includes","map","createElement","key","_id","name","balance","concat","newData","activitySearchQuery","account","activityList","slice","reverse","activity","Date","date","toLocaleString","Fragment","className","onClick","style","display","justifyContent","marginBottom","type","placeholder","value","onChange","e","currentTarget","id","col1","col2","col3","col4","list"],"sources":["/Users/Regan/Documents/GitHub/BadBank/public/src/Components/alldata.js"],"sourcesContent":["import React, {useEffect} from \"react\";\nimport {Table, CurrentUser} from \"./context\";\nimport { useNavigate } from \"react-router-dom\";\nimport {getBalance} from \"./loading\"\nimport { checkAuthorization } from \"./firebase\";\n\nexport default function AllData(){\n  const navigate = useNavigate();\n\n  const { currentUser, setCurrentUser } = React.useContext(CurrentUser);\n  const [data, setData] = React.useState([]);\n  const [loading, setLoading] = React.useState(true);\n  const [activityData, setActivityData] = React.useState([]);\n  const [showAllUsers, setShowAllUsers] = React.useState(true);\n  const [showActivity, setShowActivity] = React.useState(true);\n  const [userSearch, setUserSearch] = React.useState('');\n  const [activitySearch, setActivitySearch] = React.useState('');\n  const [loggedIn, setLoggedIn] = React.useState(false);\n\n\n\n  useEffect(() => {\n    async function loadPage() {\n        if (currentUser.email === '') {\n          let res = await checkAuthorization(setCurrentUser);\n          if (res) {\n            console.log(`home: user logged in`)\n            setLoading(false);\n          } else {\n            console.log(`home: no user logged in`)\n            setLoading(false);\n            navigate('/');\n          }\n        }\n        setLoading(false);\n    }\n\n    loadPage();\n}, []);\n\n\n  useEffect(() => {\n    async function loadPage() {\n        if (currentUser.email === '' || !currentUser) {\n            let res = await checkAuthorization(setCurrentUser);\n            if (!res) {\n                navigate('/');\n            }\n            setLoggedIn(true);\n        } \n        else {\n            await getBalance(setCurrentUser, currentUser.email);\n            setLoggedIn(true);\n        }\n        setLoading(false);\n    }\n    loadPage();\n}, []);\n\n  let userList;\n\n  if (currentUser.role === 'admin') {\n  React.useEffect(() => {\n    fetch('/account/all')\n    .then(response => response.json())\n    .then(data => {\n      setData(data);\n      setLoading(false);\n    });\n  }, [loggedIn]);\n\n  let userSearchQuery = data.filter((user) => {\n    return user.email && user.email.toLowerCase().includes(userSearch.toLowerCase());\n  }) || [];\n  \nuserList = userSearchQuery.map(user => (\n    <tr key={user._id}>\n      <td>{user.name}</td>\n      <td>${user.balance}</td>\n      <td>{user.email}</td>\n      <td>{user._id}</td>\n    </tr>\n  ));\n}\n\nReact.useEffect(() => {\n  fetch(`/account/getActivity/${currentUser.email}/${currentUser.role}`)\n  .then(response => response.json())\n  .then(newData => {\n    setActivityData(newData);\n    setLoading(false);\n  });\n}, [loggedIn]);\n\nlet activitySearchQuery = activityData.filter((account) => {\n  return account.email && account.email.toLowerCase().includes(activitySearch.toLowerCase());\n}) || [];\n\n\nlet activityList = activitySearchQuery.slice().reverse().map(account => (\n  <tr key={account._id}>\n    <td>{account.email}</td>\n    <td>{account.activity}</td>\n    <td>{new Date(account.date).toLocaleString()}</td>\n  </tr>\n));\n\nreturn (\n  <>\n      {!loading && (\n  <div>\n      {currentUser.role === \"admin\" && (\n        <div>\n         <h1 className=\"tableheader\"><a  className=\"myLink\" onClick={ () => setShowAllUsers(!showAllUsers) }>Admin: All Users</a></h1>\n        { showAllUsers && ( <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '10px' }}>\n         <input type=\"text\" placeholder=\"Search by Email\" value={userSearch} onChange={e => {\n                setUserSearch(e.currentTarget.value);\n                }}></input>\n                </div>\n                )}\n      \n      {showAllUsers && (\n      \n  <Table\n  id=\"usertable\"\n  col1=\"Name\"\n  col2=\"Balance\"\n  col3=\"Email\"\n  col4=\"ID\"\n  list={userList}\n  />\n      )}\n      </div>\n     )}\n     <div>\n     {currentUser.role === \"admin\" ? (\n      <div>\n     <h1 className=\"tableheader\"><a className=\"myLink\" onClick= { () => setShowActivity(!showActivity)}>Admin: All Bank Activity</a></h1>\n     {showActivity && (\n      <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '10px' }}>\n        <input type=\"text\" placeholder=\"Search by Email\" value={activitySearch} onChange={e => {setActivitySearch(e.currentTarget.value);\n        }}>\n        </input>\n        </div>\n              )}\n     </div>\n     \n     ) : (\n      <h1 className=\"tableheader\">My Activity</h1>\n     ) }\n\n      {showActivity && (\n\n<Table\n  id=\"activitytable\"\n  col1=\"Email\"\n  col2=\"Activity\"\n  col3=\"Date\"\n  list={activityList}\n  />\n      )}\n  </div>\n  </div>\n      )};\n  </>\n);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}